{"priority": "major", "kind": "bug", "repository": {"links": {"self": {"href": "data/repositories/osrf/subt.json"}, "html": {"href": "#!/osrf/subt"}, "avatar": {"href": "data/bytebucket.org/ravatar/{3c95f6ad-c304-407c-b838-09597d836552}ts=2272898"}}, "type": "repository", "name": "subt", "full_name": "osrf/subt", "uuid": "{3c95f6ad-c304-407c-b838-09597d836552}"}, "links": {"attachments": {"href": "data/repositories/osrf/subt/issues/97/attachments_page=1.json"}, "self": {"href": "data/repositories/osrf/subt/issues/97.json"}, "watch": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/subt/issues/97/watch"}, "comments": {"href": "data/repositories/osrf/subt/issues/97/comments_page=1.json"}, "html": {"href": "#!/osrf/subt/issues/97/potential-issue-with-x3-x4-control-via"}, "vote": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/subt/issues/97/vote"}}, "reporter": {"display_name": "Arthur Schang", "uuid": "{1403972a-9b64-442b-a69c-d7e9557e1d87}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B1403972a-9b64-442b-a69c-d7e9557e1d87%7D"}, "html": {"href": "https://bitbucket.org/%7B1403972a-9b64-442b-a69c-d7e9557e1d87%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/initials/AS-0.png"}}, "nickname": "Arthur Schang", "type": "user", "account_id": "557058:14b7fd50-d65a-47a8-825c-fa89681d07bd"}, "title": "Potential Issue with X3/X4 Control (via cmd_vel)", "component": null, "votes": 2, "watches": 10, "content": {"raw": "The cmd\\_vel interface on the X3/X4 vehicles does not work intuitively as one would expect:  \r\nExample on X3 Config 1:  \r\nCommand 1.0 m/s Z velocity \\(all others zero\\) -> the rotors slowly spin at a constant rate  \r\nCommand 15.0 m/s Z velocity \\(all others zero\\) -> the rotors spin up and the vehicle slowly lifts off\r\n\r\nThere are two issues present with the current setup using the UKF feedback to the roll\\_pitch\\_yawrate\\_thrust\\_controller\\_node from rotors\\_gazebo:\r\n\r\n1. Incorrect gains or missing feedback for the X3/X4 vehicles' roll\\_pitch\\_yawrate\\_thrust\\_controller\\_node  \r\n  -The odometry put out by the UKF seems to be all zero which should cause the controller to continue to increase thrust by ramping up each rotor until 1.0 m/s is measured by the odometry.  This does not happen and there is a constant rotor speed so there may be missing feedback or insufficient gains for some terms.\r\n2. Measuring velocity from only the IMU is going to be suboptimal.  Competitors will need to feed their own odometry estimate on some documented topic to the UKF to get good results.  A way to test whether or not a good odometry estimate from a competitor would work might be using truth from Ignition to ensure that the control is sufficient with perfect odometry.\r\n\r\nThis is related to issue #94", "markup": "markdown", "html": "<p>The cmd_vel interface on the X3/X4 vehicles does not work intuitively as one would expect:<br />\nExample on X3 Config 1:<br />\nCommand 1.0 m/s Z velocity (all others zero) -&gt; the rotors slowly spin at a constant rate<br />\nCommand 15.0 m/s Z velocity (all others zero) -&gt; the rotors spin up and the vehicle slowly lifts off</p>\n<p>There are two issues present with the current setup using the UKF feedback to the roll_pitch_yawrate_thrust_controller_node from rotors_gazebo:</p>\n<ol>\n<li>Incorrect gains or missing feedback for the X3/X4 vehicles' roll_pitch_yawrate_thrust_controller_node<br />\n  -The odometry put out by the UKF seems to be all zero which should cause the controller to continue to increase thrust by ramping up each rotor until 1.0 m/s is measured by the odometry.  This does not happen and there is a constant rotor speed so there may be missing feedback or insufficient gains for some terms.</li>\n<li>Measuring velocity from only the IMU is going to be suboptimal.  Competitors will need to feed their own odometry estimate on some documented topic to the UKF to get good results.  A way to test whether or not a good odometry estimate from a competitor would work might be using truth from Ignition to ensure that the control is sufficient with perfect odometry.</li>\n</ol>\n<p>This is related to issue <a href=\"#!/osrf/subt/issues/94/x3-x4-misconfigured-odom-no-resposne-to\" rel=\"nofollow\" title=\"X3/X4 Misconfigured Odom (No Resposne to Velocity Commands on /&lt;vehicle_name&gt;/cmd_vel)\" class=\"ap-connect-link\"><s>#94</s></a></p>", "type": "rendered"}, "assignee": {"display_name": "Addisu Z. Taddese", "uuid": "{9d7fdc68-d270-4080-bf03-4df0d0dbf635}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D"}, "html": {"href": "https://bitbucket.org/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:90bc87b0-2886-4377-a17c-3a6629a697ff/afbf9be5-1e4c-4810-89d4-e58831f34b11/128"}}, "nickname": "azeey", "type": "user", "account_id": "557058:90bc87b0-2886-4377-a17c-3a6629a697ff"}, "state": "closed", "version": null, "edited_on": null, "created_on": "2019-07-03T16:19:06.035028+00:00", "milestone": null, "updated_on": "2019-10-31T05:59:45.731705+00:00", "type": "issue", "id": 97}